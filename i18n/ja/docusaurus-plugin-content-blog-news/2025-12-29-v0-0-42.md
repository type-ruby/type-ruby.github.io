---
slug: v0-0-42-release
title: T-Ruby v0.0.42 リリース
authors: [yhk1038]
tags: [release, feature]
date: 2025-12-29T02:00:00
---

T-Ruby v0.0.42 は、クリスマスにリリースされた Ruby 4.0 を完全サポートします。([PR#28](https://github.com/type-ruby/t-ruby/pull/28))

<!-- truncate -->

## Ruby 4.0 サポート

> 📖 参照: [CLI リファレンス](/docs/cli/commands)

2025年クリスマスにリリースされた Ruby 4.0 を完全サポートします：

### RubyVersion 値オブジェクト

新しい `RubyVersion` クラスがバージョンの解析、比較、機能検出を処理します：

```ruby
version = TRuby::RubyVersion.new("3.2.0")
version.major  # => 3
version.minor  # => 2
version >= TRuby::RubyVersion.new("3.0")  # => true
```

### バージョン固有のコード生成

新しい `CodeEmitter` ストラテジーパターンが、異なる Ruby バージョンに適したコードを生成します：

- 環境からターゲット Ruby バージョンを自動検出
- Ruby 3.0 から 4.0 までのバージョン固有の変換
- 3.0-4.x 範囲外のバージョンに対する `UnsupportedRubyVersionError`

### ブロックパラメータの型削除

ブロックパラメータから型アノテーションが削除されます。

## CI の改善

- 将来の互換性テストのため CI マトリックスに `ruby-head` を追加
- ruby-head ビルドで `continue-on-error` を有効化

## 依存関係の更新

- `benchmark` gem を明示的な依存関係として追加（deprecation 警告を解決）
- Ruby 4.0 の ffi 互換性のため `listen` gem をオプショナルに変更

## アップグレード

```bash
gem update t-ruby
```

## 今後の展望

Ruby 4.0 が正式にリリースされた今、T-Ruby は Ruby 3.0+ との下位互換性を維持しながら、最新の Ruby バージョンのサポートに引き続き尽力しています。
