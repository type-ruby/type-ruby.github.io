---
slug: v0-0-40-release
title: T-Ruby v0.0.40 ãƒªãƒªãƒ¼ã‚¹
authors: [yhk1038]
tags: [release, parser]
---

T-Ruby v0.0.40 ã§ã¯ã€ã‚¢ã‚¯ã‚»ã‚¹ä¿®é£¾å­ã®ã‚µãƒãƒ¼ãƒˆã‚„ heredoc æ¤œå‡ºãªã©ã€ãƒ‘ãƒ¼ã‚µãƒ¼ãŒå¤§å¹…ã«æ”¹å–„ã•ã‚Œã¾ã—ãŸã€‚([PR#22](https://github.com/type-ruby/t-ruby/pull/22))

<!-- truncate -->

## ã‚¢ã‚¯ã‚»ã‚¹ä¿®é£¾å­ã®ã‚µãƒãƒ¼ãƒˆ

> ğŸ“– å‚ç…§: [ã‚¯ãƒ©ã‚¹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³](/docs/learn/classes/class-annotations)

Ruby ã®ã‚¢ã‚¯ã‚»ã‚¹ä¿®é£¾å­ã‚’ãƒ¡ã‚½ãƒƒãƒ‰å®šç¾©ã¨ä¸€ç·’ã«ç›´æ¥ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼š

```ruby
private def secret_method(key: String): String
  # ...
end

protected def internal_method(data: Hash): Boolean
  # ...
end
```

T-Ruby ã¯ã“ã‚Œã‚‰ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ­£ã—ããƒ‘ãƒ¼ã‚¹ã—ã€å‹å‰Šé™¤æ™‚ã«ã‚¢ã‚¯ã‚»ã‚¹ä¿®é£¾å­ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä¿æŒã—ã¾ã™ã€‚

## Heredoc æ¤œå‡º

æ–°ã—ã„ `HeredocDetector` ãŒ heredoc æ–‡å­—åˆ—å†…ã§ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®èª¤æ¤œå‡ºã‚’é˜²æ­¢ã—ã¾ã™ï¼š

```ruby
message = <<~SQL
  def fake_method  # ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦ãƒ‘ãƒ¼ã‚¹ã•ã‚Œãªã„
    SELECT * FROM users
  end
SQL
```

ã™ã¹ã¦ã® heredoc ãƒãƒªã‚¢ãƒ³ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆï¼š`<<DELIM`ã€`<<-DELIM`ã€`<<~DELIM`ã€`<<'DELIM'`ã€`<<"DELIM"`ã€‚

## ãƒ–ãƒ­ãƒƒã‚¯ã‚³ãƒ¡ãƒ³ãƒˆã®ã‚µãƒãƒ¼ãƒˆ

ãƒ‘ãƒ¼ã‚µãƒ¼ãŒ `=begin`/`=end` ãƒ–ãƒ­ãƒƒã‚¯ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ­£ã—ãã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

## RBS ã‚¢ã‚¯ã‚»ã‚¹ä¿®é£¾å­ã‚µãƒãƒ¼ãƒˆ

ç”Ÿæˆã•ã‚ŒãŸ `.rbs` ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ä¿®é£¾å­ãŒå«ã¾ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼š

```rbs
private def secret_method: (key: String) -> String
```

## ãƒ¬ã‚¬ã‚·ãƒ¼ã‚³ãƒ¼ãƒ‰ã®å‰Šé™¤

ã“ã®ãƒªãƒªãƒ¼ã‚¹ã§ã¯ã€éæ¨å¥¨ã®ãƒ¬ã‚¬ã‚·ãƒ¼ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚³ãƒ¼ãƒ‰ãŒå‰Šé™¤ã•ã‚Œã¾ã—ãŸï¼š
- `LegacyParser` ã‚¯ãƒ©ã‚¹ã®å‰Šé™¤
- `LegacyCompiler` ã‚¯ãƒ©ã‚¹ã®å‰Šé™¤
- `TRuby::RBSGenerator` ã®å‰Šé™¤ï¼ˆ`IR::RBSGenerator` ã‚’ä½¿ç”¨ï¼‰
- `use_ir` ãŠã‚ˆã³ `use_combinator` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‰Šé™¤ï¼ˆå¸¸ã« IR ã‚’ä½¿ç”¨ï¼‰

## ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰

```bash
gem update t-ruby
```
