"use strict";(globalThis.webpackChunkt_ruby_docs=globalThis.webpackChunkt_ruby_docs||[]).push([[7390],{7390:(e,n,r)=>{r.d(n,{loadTRubyCompiler:()=>u});const s="https://cdn.jsdelivr.net/npm/@ruby/3.3-wasm-wasi@2.7.0/dist/browser/+esm",t="https://cdn.jsdelivr.net/npm/@ruby/3.3-wasm-wasi@2.7.0/dist/ruby+stdlib.wasm";let o=null,a=null,i=null;const l='\nrequire "json"\n\n# Global compiler instance\n$trb_compiler = nil\n\ndef get_compiler\n  $trb_compiler ||= TRuby::Compiler.new\nend\n\ndef __trb_compile__(code)\n  compiler = get_compiler\n\n  begin\n    result = compiler.compile_string(code)\n\n    {\n      success: result[:errors].empty?,\n      ruby: result[:ruby] || "",\n      rbs: result[:rbs] || "",\n      errors: result[:errors] || []\n    }.to_json\n  rescue TRuby::ParseError => e\n    {\n      success: false,\n      ruby: "",\n      rbs: "",\n      errors: [e.message]\n    }.to_json\n  rescue StandardError => e\n    {\n      success: false,\n      ruby: "",\n      rbs: "",\n      errors: ["Compilation error: " + e.message]\n    }.to_json\n  end\nend\n\ndef __trb_health_check__\n  {\n    loaded: defined?(TRuby) == "constant",\n    version: defined?(TRuby::VERSION) ? TRuby::VERSION : "unknown",\n    ruby_version: RUBY_VERSION\n  }.to_json\nend\n\ndef __trb_version__\n  {\n    t_ruby: defined?(TRuby::VERSION) ? TRuby::VERSION : "unknown",\n    ruby: RUBY_VERSION\n  }.to_json\nend\n';async function u(e){if(a)return e?.({state:"ready",message:"Compiler ready"}),a;if(i)return i;i=async function(e){try{e?.({state:"loading",message:"Loading Ruby runtime...",progress:10});const{DefaultRubyVM:n}=await import(s);e?.({state:"loading",message:"Downloading Ruby WASM binary...",progress:30});const r=await fetch(t),a=await WebAssembly.compileStreaming(r);e?.({state:"loading",message:"Initializing Ruby VM...",progress:60});const{vm:i}=await n(a);return o=i,e?.({state:"loading",message:"Loading T-Ruby compiler...",progress:80}),i.eval(l),e?.({state:"ready",message:"Compiler ready",progress:100}),{compile(e){const n=i.eval(`__trb_compile__(${JSON.stringify(e)})`);return JSON.parse(n.toString())},healthCheck(){const e=i.eval("__trb_health_check__");return JSON.parse(e.toString())},getVersion(){const e=i.eval("__trb_version__");return JSON.parse(e.toString())}}}catch(n){throw e?.({state:"error",message:n instanceof Error?n.message:"Unknown error"}),n}}(e);try{return a=await i,a}catch(n){throw i=null,n}}}}]);