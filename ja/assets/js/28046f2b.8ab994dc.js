"use strict";(globalThis.webpackChunkt_ruby_docs=globalThis.webpackChunkt_ruby_docs||[]).push([[6625],{5305(e,n,r){r.r(n),r.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>o,frontMatter:()=>d,metadata:()=>i,toc:()=>h});var i=r(8235),l=r(5656),s=r(6145);const d={slug:"typescript-style-type-inference",title:"T-Ruby\u306e\u305f\u3081\u306eTypeScript\u30b9\u30bf\u30a4\u30eb\u578b\u63a8\u8ad6\u306e\u69cb\u7bc9",authors:["yhk1038"],tags:["technical","type-inference","compiler"]},c=void 0,t={authorsImageUrls:[void 0]},h=[{value:"\u554f\u984c\u70b9",id:"\u554f\u984c\u70b9",level:2},{value:"\u30a4\u30f3\u30b9\u30d4\u30ec\u30fc\u30b7\u30e7\u30f3\uff1aTypeScript\u306e\u30a2\u30d7\u30ed\u30fc\u30c1",id:"\u30a4\u30f3\u30b9\u30d4\u30ec\u30fc\u30b7\u30e7\u30f3typescript\u306e\u30a2\u30d7\u30ed\u30fc\u30c1",level:2},{value:"TypeScript\u306e\u52d5\u4f5c\u65b9\u6cd5",id:"typescript\u306e\u52d5\u4f5c\u65b9\u6cd5",level:3},{value:"\u79c1\u305f\u3061\u306e\u7c21\u7565\u5316\u3055\u308c\u305f\u30a2\u30d7\u30ed\u30fc\u30c1",id:"\u79c1\u305f\u3061\u306e\u7c21\u7565\u5316\u3055\u308c\u305f\u30a2\u30d7\u30ed\u30fc\u30c1",level:3},{value:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3",id:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3",level:2},{value:"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8",id:"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8",level:3},{value:"1. BodyParser - \u30e1\u30bd\u30c3\u30c9\u672c\u4f53\u306e\u30d1\u30fc\u30b9",id:"1-bodyparser---\u30e1\u30bd\u30c3\u30c9\u672c\u4f53\u306e\u30d1\u30fc\u30b9",level:4},{value:"2. TypeEnv - \u30b9\u30b3\u30fc\u30d7\u30c1\u30a7\u30fc\u30f3\u7ba1\u7406",id:"2-typeenv---\u30b9\u30b3\u30fc\u30d7\u30c1\u30a7\u30fc\u30f3\u7ba1\u7406",level:4},{value:"3. ASTTypeInferrer - \u578b\u63a8\u8ad6\u30a8\u30f3\u30b8\u30f3",id:"3-asttypeinferrer---\u578b\u63a8\u8ad6\u30a8\u30f3\u30b8\u30f3",level:4},{value:"Ruby\u306e\u6697\u9ed9\u7684\u306a\u623b\u308a\u5024\u306e\u51e6\u7406",id:"ruby\u306e\u6697\u9ed9\u7684\u306a\u623b\u308a\u5024\u306e\u51e6\u7406",level:3},{value:"\u7279\u6b8a\u30b1\u30fc\u30b9\uff1a<code>initialize</code>\u30e1\u30bd\u30c3\u30c9",id:"\u7279\u6b8a\u30b1\u30fc\u30b9initialize\u30e1\u30bd\u30c3\u30c9",level:3},{value:"\u7d44\u307f\u8fbc\u307f\u30e1\u30bd\u30c3\u30c9\u306e\u578b\u77e5\u8b58",id:"\u7d44\u307f\u8fbc\u307f\u30e1\u30bd\u30c3\u30c9\u306e\u578b\u77e5\u8b58",level:3},{value:"\u7d50\u679c",id:"\u7d50\u679c",level:2},{value:"\u30c6\u30b9\u30c8",id:"\u30c6\u30b9\u30c8",level:2},{value:"\u8ab2\u984c\u3068\u89e3\u6c7a\u7b56",id:"\u8ab2\u984c\u3068\u89e3\u6c7a\u7b56",level:2},{value:"\u4eca\u5f8c\u306e\u8a08\u753b",id:"\u4eca\u5f8c\u306e\u8a08\u753b",level:2},{value:"\u7d50\u8ad6",id:"\u7d50\u8ad6",level:2}];function a(e){const n={code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.p,{children:"\u660e\u793a\u7684\u306a\u578b\u5ba3\u8a00\u306a\u3057\u3067\u81ea\u52d5\u7684\u306b\u578b\u3092\u691c\u51fa\u3059\u308b\u3001TypeScript\u306b\u89e6\u767a\u3055\u308c\u305f\u9759\u7684\u578b\u63a8\u8ad6\u3092T-Ruby\u306b\u5b9f\u88c5\u3057\u305f\u8a71\u3067\u3059\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"\u554f\u984c\u70b9",children:"\u554f\u984c\u70b9"}),"\n",(0,l.jsx)(n.p,{children:"T-Ruby\u30b3\u30fc\u30c9\u3092\u66f8\u304f\u969b\u3001\u958b\u767a\u8005\u306f\u3059\u3079\u3066\u306e\u623b\u308a\u5024\u306e\u578b\u3092\u660e\u793a\u7684\u306b\u5ba3\u8a00\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3057\u305f\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ruby",children:'def greet(name: String): String\n  "Hello, #{name}!"\nend\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:": String"}),"\u306e\u623b\u308a\u5024\u578b\u304c\u306a\u3044\u3068\u3001\u751f\u6210\u3055\u308c\u308bRBS\u306f",(0,l.jsx)(n.code,{children:"untyped"}),"\u3068\u8868\u793a\u3055\u308c\u307e\u3059\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rbs",children:"def greet: (name: String) -> untyped\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u3053\u308c\u306f\u4e0d\u4fbf\u3067\u3057\u305f\u3002\u623b\u308a\u5024\u306e\u578b\u306f\u660e\u3089\u304b\u306b",(0,l.jsx)(n.code,{children:"String"}),"\u306a\u306e\u306b - \u306a\u305cT-Ruby\u304c\u81ea\u52d5\u3067\u5224\u65ad\u3067\u304d\u306a\u3044\u306e\u3067\u3057\u3087\u3046\u304b\uff1f"]}),"\n",(0,l.jsx)(n.h2,{id:"\u30a4\u30f3\u30b9\u30d4\u30ec\u30fc\u30b7\u30e7\u30f3typescript\u306e\u30a2\u30d7\u30ed\u30fc\u30c1",children:"\u30a4\u30f3\u30b9\u30d4\u30ec\u30fc\u30b7\u30e7\u30f3\uff1aTypeScript\u306e\u30a2\u30d7\u30ed\u30fc\u30c1"}),"\n",(0,l.jsx)(n.p,{children:"TypeScript\u306f\u3053\u308c\u3092\u30a8\u30ec\u30ac\u30f3\u30c8\u306b\u51e6\u7406\u3057\u307e\u3059\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"function greet(name: string) {\n  return `Hello, ${name}!`;\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["TypeScript\u306f\u623b\u308a\u5024\u306e\u578b\u3092",(0,l.jsx)(n.code,{children:"string"}),"\u3068\u63a8\u8ad6\u3057\u307e\u3059\u3002\u79c1\u305f\u3061\u3082T-Ruby\u3067\u540c\u3058\u4f53\u9a13\u3092\u671b\u3093\u3067\u3044\u307e\u3057\u305f\u3002"]}),"\n",(0,l.jsx)(n.h3,{id:"typescript\u306e\u52d5\u4f5c\u65b9\u6cd5",children:"TypeScript\u306e\u52d5\u4f5c\u65b9\u6cd5"}),"\n",(0,l.jsx)(n.p,{children:"TypeScript\u306e\u578b\u63a8\u8ad6\u306f2\u3064\u306e\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3067\u69cb\u6210\u3055\u308c\u3066\u3044\u307e\u3059\uff1a"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Binder"}),"\uff1a\u30d1\u30fc\u30b9\u4e2d\u306b\u5236\u5fa1\u30d5\u30ed\u30fc\u30b0\u30e9\u30d5\uff08CFG\uff09\u3092\u69cb\u7bc9"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Checker"}),"\uff1a\u5fc5\u8981\u306a\u3068\u304d\u306b\u9045\u5ef6\u8a55\u4fa1\u3067\u578b\u3092\u8a08\u7b97\u3001\u30d5\u30ed\u30fc\u5206\u6790\u3092\u4f7f\u7528"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["\u9b54\u6cd5\u306f",(0,l.jsx)(n.code,{children:"getFlowTypeOfReference"}),"\u3067\u8d77\u3053\u308a\u307e\u3059 - \u30d5\u30ed\u30fc\u30ce\u30fc\u30c9\u3092\u9006\u65b9\u5411\u306b\u305f\u3069\u308a\u306a\u304c\u3089\u3001\u30b3\u30fc\u30c9\u306e\u3069\u306e\u5730\u70b9\u3067\u3082\u30b7\u30f3\u30dc\u30eb\u306e\u578b\u3092\u6c7a\u5b9a\u3059\u308b1200\u884c\u4ee5\u4e0a\u306e\u95a2\u6570\u3067\u3059\u3002"]}),"\n",(0,l.jsx)(n.h3,{id:"\u79c1\u305f\u3061\u306e\u7c21\u7565\u5316\u3055\u308c\u305f\u30a2\u30d7\u30ed\u30fc\u30c1",children:"\u79c1\u305f\u3061\u306e\u7c21\u7565\u5316\u3055\u308c\u305f\u30a2\u30d7\u30ed\u30fc\u30c1"}),"\n",(0,l.jsx)(n.p,{children:"Ruby\u306e\u5236\u5fa1\u30d5\u30ed\u30fc\u306fJavaScript\u3088\u308a\u5358\u7d14\u3067\u3059\u3002TypeScript\u306e\u30d5\u30ed\u30fc\u30b0\u30e9\u30d5\u306e\u5b8c\u5168\u306a\u8907\u96d1\u3055\u306f\u5fc5\u8981\u3042\u308a\u307e\u305b\u3093\u3002\u4ee3\u308f\u308a\u306b\u4ee5\u4e0b\u3092\u5b9f\u88c5\u3057\u307e\u3057\u305f\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7dda\u5f62\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc\u5206\u6790"})," - Ruby\u306e\u76f4\u611f\u7684\u306a\u5b9f\u884c\u30e2\u30c7\u30eb"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u95a2\u5fc3\u306e\u5206\u96e2"})," - IR Builder\uff08Binder\u306e\u5f79\u5272\uff09+ ASTTypeInferrer\uff08Checker\u306e\u5f79\u5272\uff09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u9045\u5ef6\u8a55\u4fa1"})," - RBS\u751f\u6210\u6642\u306b\u306e\u307f\u578b\u3092\u8a08\u7b97"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3",children:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"[Binder\u30b9\u30c6\u30fc\u30b8 - IR Builder]\n\u30bd\u30fc\u30b9 (.trb) \u2192 Parser \u2192 IR\u30c4\u30ea\u30fc\uff08\u30e1\u30bd\u30c3\u30c9\u672c\u4f53\u3092\u542b\u3080\uff09\n\n[Checker\u30b9\u30c6\u30fc\u30b8 - Type Inferrer]\nIR\u30ce\u30fc\u30c9\u8d70\u67fb \u2192 \u578b\u6c7a\u5b9a \u2192 \u30ad\u30e3\u30c3\u30b7\u30f3\u30b0\n\n[\u51fa\u529b\u30b9\u30c6\u30fc\u30b8]\n\u63a8\u8ad6\u3055\u308c\u305f\u578b \u2192 RBS\u751f\u6210\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8",children:"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"}),"\n",(0,l.jsx)(n.h4,{id:"1-bodyparser---\u30e1\u30bd\u30c3\u30c9\u672c\u4f53\u306e\u30d1\u30fc\u30b9",children:"1. BodyParser - \u30e1\u30bd\u30c3\u30c9\u672c\u4f53\u306e\u30d1\u30fc\u30b9"}),"\n",(0,l.jsxs)(n.p,{children:["\u6700\u521d\u306e\u8ab2\u984c\u306f\u3001\u30d1\u30fc\u30b5\u30fc\u304c\u30e1\u30bd\u30c3\u30c9\u672c\u4f53\u3092\u5206\u6790\u3057\u3066\u3044\u306a\u304b\u3063\u305f\u3053\u3068\u3067\u3059 - \u30b7\u30b0\u30cd\u30c1\u30e3\u306e\u307f\u3092\u62bd\u51fa\u3057\u3066\u3044\u307e\u3057\u305f\u3002T-Ruby\u30e1\u30bd\u30c3\u30c9\u672c\u4f53\u3092IR\u30ce\u30fc\u30c9\u306b\u5909\u63db\u3059\u308b",(0,l.jsx)(n.code,{children:"BodyParser"}),"\u3092\u69cb\u7bc9\u3057\u307e\u3057\u305f\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ruby",children:"class BodyParser\n  def parse(lines, start_line, end_line)\n    statements = []\n    # \u5404\u884c\u3092IR\u30ce\u30fc\u30c9\u306b\u30d1\u30fc\u30b9\n    # \u51e6\u7406\uff1a\u30ea\u30c6\u30e9\u30eb\u3001\u5909\u6570\u3001\u6f14\u7b97\u5b50\u3001\u30e1\u30bd\u30c3\u30c9\u547c\u3073\u51fa\u3057\u3001\u6761\u4ef6\u6587\n    IR::Block.new(statements: statements)\n  end\nend\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u30b5\u30dd\u30fc\u30c8\u3059\u308b\u69cb\u6587\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u30ea\u30c6\u30e9\u30eb\uff1a",(0,l.jsx)(n.code,{children:'"hello"'}),"\u3001",(0,l.jsx)(n.code,{children:"42"}),"\u3001",(0,l.jsx)(n.code,{children:"true"}),"\u3001",(0,l.jsx)(n.code,{children:":symbol"})]}),"\n",(0,l.jsxs)(n.li,{children:["\u5909\u6570\uff1a",(0,l.jsx)(n.code,{children:"name"}),"\u3001",(0,l.jsx)(n.code,{children:"@instance_var"}),"\u3001",(0,l.jsx)(n.code,{children:"@@class_var"})]}),"\n",(0,l.jsxs)(n.li,{children:["\u6f14\u7b97\u5b50\uff1a",(0,l.jsx)(n.code,{children:"a + b"}),"\u3001",(0,l.jsx)(n.code,{children:"x == y"}),"\u3001",(0,l.jsx)(n.code,{children:"!flag"})]}),"\n",(0,l.jsxs)(n.li,{children:["\u30e1\u30bd\u30c3\u30c9\u547c\u3073\u51fa\u3057\uff1a",(0,l.jsx)(n.code,{children:"str.upcase"}),"\u3001",(0,l.jsx)(n.code,{children:"array.map { |x| x * 2 }"})]}),"\n",(0,l.jsxs)(n.li,{children:["\u6761\u4ef6\u6587\uff1a",(0,l.jsx)(n.code,{children:"if"}),"/",(0,l.jsx)(n.code,{children:"unless"}),"/",(0,l.jsx)(n.code,{children:"elsif"}),"/",(0,l.jsx)(n.code,{children:"else"})]}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"2-typeenv---\u30b9\u30b3\u30fc\u30d7\u30c1\u30a7\u30fc\u30f3\u7ba1\u7406",children:"2. TypeEnv - \u30b9\u30b3\u30fc\u30d7\u30c1\u30a7\u30fc\u30f3\u7ba1\u7406"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ruby",children:"class TypeEnv\n  def initialize(parent = nil)\n    @parent = parent\n    @bindings = {}       # \u30ed\u30fc\u30ab\u30eb\u5909\u6570\n    @instance_vars = {}  # \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5909\u6570\n  end\n\n  def lookup(name)\n    @bindings[name] || @instance_vars[name] || @parent&.lookup(name)\n  end\n\n  def child_scope\n    TypeEnv.new(self)\n  end\nend\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u3053\u308c\u306b\u3088\u308a\u9069\u5207\u306a\u30b9\u30b3\u30fc\u30d4\u30f3\u30b0\u304c\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059 - \u30e1\u30bd\u30c3\u30c9\u306e\u30ed\u30fc\u30ab\u30eb\u5909\u6570\u306f\u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u306b\u6f0f\u308c\u307e\u305b\u3093\u304c\u3001\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u5909\u6570\u306f\u30af\u30e9\u30b9\u5168\u4f53\u3067\u5171\u6709\u3055\u308c\u307e\u3059\u3002"}),"\n",(0,l.jsx)(n.h4,{id:"3-asttypeinferrer---\u578b\u63a8\u8ad6\u30a8\u30f3\u30b8\u30f3",children:"3. ASTTypeInferrer - \u578b\u63a8\u8ad6\u30a8\u30f3\u30b8\u30f3"}),"\n",(0,l.jsx)(n.p,{children:"\u30b7\u30b9\u30c6\u30e0\u306e\u5fc3\u81d3\u90e8\u3067\u3059\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ruby",children:'class ASTTypeInferrer\n  LITERAL_TYPE_MAP = {\n    string: "String",\n    integer: "Integer",\n    float: "Float",\n    boolean: "bool",\n    symbol: "Symbol",\n    nil: "nil"\n  }.freeze\n\n  def infer_expression(node, env)\n    # \u307e\u305a\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u78ba\u8a8d\uff08\u9045\u5ef6\u8a55\u4fa1\uff09\n    return @type_cache[node.object_id] if @type_cache[node.object_id]\n\n    type = case node\n    when IR::Literal\n      LITERAL_TYPE_MAP[node.literal_type]\n    when IR::VariableRef\n      env.lookup(node.name)\n    when IR::BinaryOp\n      infer_binary_op(node, env)\n    when IR::MethodCall\n      infer_method_call(node, env)\n    # ... \u305d\u306e\u4ed6\u306e\u30b1\u30fc\u30b9\n    end\n\n    @type_cache[node.object_id] = type\n  end\nend\n'})}),"\n",(0,l.jsx)(n.h3,{id:"ruby\u306e\u6697\u9ed9\u7684\u306a\u623b\u308a\u5024\u306e\u51e6\u7406",children:"Ruby\u306e\u6697\u9ed9\u7684\u306a\u623b\u308a\u5024\u306e\u51e6\u7406"}),"\n",(0,l.jsx)(n.p,{children:"Ruby\u306e\u6700\u5f8c\u306e\u5f0f\u306f\u6697\u9ed9\u7684\u306a\u623b\u308a\u5024\u3067\u3059\u3002\u3053\u308c\u306f\u578b\u63a8\u8ad6\u306b\u3068\u3063\u3066\u975e\u5e38\u306b\u91cd\u8981\u3067\u3059\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ruby",children:'def status\n  if active?\n    "running"\n  else\n    "stopped"\n  end\nend\n# \u6697\u9ed9\u7684\u306a\u623b\u308a\u5024\uff1aString\uff08\u4e21\u65b9\u306e\u5206\u5c90\u304b\u3089\uff09\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u79c1\u305f\u3061\u306f\u3053\u308c\u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u51e6\u7406\u3057\u307e\u3059\uff1a"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\u3059\u3079\u3066\u306e\u660e\u793a\u7684\u306a",(0,l.jsx)(n.code,{children:"return"}),"\u578b\u3092\u53ce\u96c6"]}),"\n",(0,l.jsx)(n.li,{children:"\u6700\u5f8c\u306e\u5f0f\u3092\u898b\u3064\u3051\u308b\uff08\u6697\u9ed9\u7684\u306a\u623b\u308a\u5024\uff09"}),"\n",(0,l.jsx)(n.li,{children:"\u3059\u3079\u3066\u306e\u623b\u308a\u5024\u578b\u3092\u7d71\u5408"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ruby",children:"def infer_method_return_type(method_node, env)\n  # \u660e\u793a\u7684\u306areturn\u3092\u53ce\u96c6\n  return_types, terminated = collect_return_types(method_node.body, env)\n\n  # \u6697\u9ed9\u7684\u306a\u623b\u308a\u5024\u3092\u8ffd\u52a0\uff08\u30e1\u30bd\u30c3\u30c9\u304c\u5e38\u306b\u660e\u793a\u7684\u306b\u623b\u3089\u306a\u3044\u5834\u5408\uff09\n  unless terminated\n    implicit_return = infer_implicit_return(method_node.body, env)\n    return_types << implicit_return if implicit_return\n  end\n\n  unify_types(return_types)\nend\n"})}),"\n",(0,l.jsxs)(n.h3,{id:"\u7279\u6b8a\u30b1\u30fc\u30b9initialize\u30e1\u30bd\u30c3\u30c9",children:["\u7279\u6b8a\u30b1\u30fc\u30b9\uff1a",(0,l.jsx)(n.code,{children:"initialize"}),"\u30e1\u30bd\u30c3\u30c9"]}),"\n",(0,l.jsxs)(n.p,{children:["Ruby\u306e",(0,l.jsx)(n.code,{children:"initialize"}),"\u306f\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3067\u3059\u3002\u623b\u308a\u5024\u306f\u7121\u8996\u3055\u308c\u307e\u3059 - ",(0,l.jsx)(n.code,{children:"Class.new"}),"\u304c\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u8fd4\u3057\u307e\u3059\u3002RBS\u306e\u6163\u4f8b\u306b\u5f93\u3044\u3001\u5e38\u306b",(0,l.jsx)(n.code,{children:"void"}),"\u3068\u63a8\u8ad6\u3057\u307e\u3059\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ruby",children:"class User\n  def initialize(name: String)\n    @name = name\n  end\nend\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u751f\u6210\u3055\u308c\u308bRBS\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rbs",children:"class User\n  def initialize: (name: String) -> void\nend\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u7d44\u307f\u8fbc\u307f\u30e1\u30bd\u30c3\u30c9\u306e\u578b\u77e5\u8b58",children:"\u7d44\u307f\u8fbc\u307f\u30e1\u30bd\u30c3\u30c9\u306e\u578b\u77e5\u8b58"}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u822c\u7684\u306aRuby\u30e1\u30bd\u30c3\u30c9\u306e\u623b\u308a\u5024\u578b\u30c6\u30fc\u30d6\u30eb\u3092\u7dad\u6301\u3057\u3066\u3044\u307e\u3059\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ruby",children:'BUILTIN_METHOD_TYPES = {\n  %w[String upcase] => "String",\n  %w[String downcase] => "String",\n  %w[String length] => "Integer",\n  %w[String to_i] => "Integer",\n  %w[Array first] => "untyped",  # \u8981\u7d20\u578b\n  %w[Array length] => "Integer",\n  %w[Integer to_s] => "String",\n  # ... 200\u4ee5\u4e0a\u306e\u30e1\u30bd\u30c3\u30c9\n}.freeze\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u7d50\u679c",children:"\u7d50\u679c"}),"\n",(0,l.jsx)(n.p,{children:"\u4eca\u3067\u306f\u3053\u306eT-Ruby\u30b3\u30fc\u30c9\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ruby",children:'class Greeter\n  def initialize(name: String)\n    @name = name\n  end\n\n  def greet\n    "Hello, #{@name}!"\n  end\n\n  def shout\n    @name.upcase\n  end\nend\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u6b63\u3057\u3044RBS\u3092\u81ea\u52d5\u7684\u306b\u751f\u6210\u3057\u307e\u3059\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rbs",children:"class Greeter\n  @name: String\n\n  def initialize: (name: String) -> void\n  def greet: () -> String\n  def shout: () -> String\nend\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u660e\u793a\u7684\u306a\u623b\u308a\u5024\u578b\u306f\u4e0d\u8981\u3067\u3059\uff01"}),"\n",(0,l.jsx)(n.h2,{id:"\u30c6\u30b9\u30c8",children:"\u30c6\u30b9\u30c8"}),"\n",(0,l.jsx)(n.p,{children:"\u5305\u62ec\u7684\u306a\u30c6\u30b9\u30c8\u3092\u69cb\u7bc9\u3057\u307e\u3057\u305f\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8"}),"\uff1a\u30ea\u30c6\u30e9\u30eb\u63a8\u8ad6\u3001\u6f14\u7b97\u5b50\u578b\u3001\u30e1\u30bd\u30c3\u30c9\u547c\u3073\u51fa\u3057\u578b"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"E2E\u30c6\u30b9\u30c8"}),"\uff1aRBS\u691c\u8a3c\u3092\u542b\u3080\u5b8c\u5168\u306a\u30b3\u30f3\u30d1\u30a4\u30eb"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ruby",children:'it "\u6587\u5b57\u5217\u30ea\u30c6\u30e9\u30eb\u304b\u3089String\u3092\u63a8\u8ad6\u3059\u308b" do\n  create_trb_file("src/test.trb", <<~TRB)\n    class Test\n      def message\n        "hello world"\n      end\n    end\n  TRB\n\n  rbs_content = compile_and_get_rbs("src/test.trb")\n  expect(rbs_content).to include("def message: () -> String")\nend\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u8ab2\u984c\u3068\u89e3\u6c7a\u7b56",children:"\u8ab2\u984c\u3068\u89e3\u6c7a\u7b56"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u8ab2\u984c"}),(0,l.jsx)(n.th,{children:"\u89e3\u6c7a\u7b56"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u30e1\u30bd\u30c3\u30c9\u672c\u4f53\u306e\u30d1\u30fc\u30b9\u304c\u306a\u3044"}),(0,l.jsx)(n.td,{children:"T-Ruby\u69cb\u6587\u7528\u306e\u30ab\u30b9\u30bf\u30e0BodyParser\u3092\u69cb\u7bc9"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u6697\u9ed9\u7684\u306a\u623b\u308a\u5024"}),(0,l.jsx)(n.td,{children:"\u30d6\u30ed\u30c3\u30af\u306e\u6700\u5f8c\u306e\u5f0f\u3092\u5206\u6790"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u518d\u5e30\u30e1\u30bd\u30c3\u30c9"}),(0,l.jsx)(n.td,{children:"2\u30d1\u30b9\u5206\u6790\uff08\u30b7\u30b0\u30cd\u30c1\u30e3\u3092\u5148\u306b\u3001\u6b21\u306b\u672c\u4f53\uff09"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u8907\u96d1\u306a\u5f0f"}),(0,l.jsx)(n.td,{children:"\u6bb5\u968e\u7684\u306b\u62e1\u5f35\uff1a\u30ea\u30c6\u30e9\u30eb \u2192 \u5909\u6570 \u2192 \u6f14\u7b97\u5b50 \u2192 \u30e1\u30bd\u30c3\u30c9\u547c\u3073\u51fa\u3057"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u30e6\u30cb\u30aa\u30f3\u578b"}),(0,l.jsx)(n.td,{children:"\u3059\u3079\u3066\u306e\u623b\u308a\u30d1\u30b9\u3092\u53ce\u96c6\u3057\u3066\u7d71\u5408"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"\u4eca\u5f8c\u306e\u8a08\u753b",children:"\u4eca\u5f8c\u306e\u8a08\u753b"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u30b8\u30a7\u30cd\u30ea\u30c3\u30af\u63a8\u8ad6"}),"\uff1a",(0,l.jsx)(n.code,{children:"[1, 2, 3]"})," \u2192 ",(0,l.jsx)(n.code,{children:"Array[Integer]"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u30d6\u30ed\u30c3\u30af/\u30e9\u30e0\u30c0\u578b"}),"\uff1a\u30d6\u30ed\u30c3\u30af\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u623b\u308a\u5024\u578b\u3092\u63a8\u8ad6"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u578b\u306e\u7d5e\u308a\u8fbc\u307f"}),"\uff1a",(0,l.jsx)(n.code,{children:"if x.is_a?(String)"}),"\u306e\u5f8c\u3067\u3088\u308a\u30b9\u30de\u30fc\u30c8\u306a\u578b"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u30af\u30ed\u30b9\u30e1\u30bd\u30c3\u30c9\u63a8\u8ad6"}),"\uff1a\u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u304b\u3089\u63a8\u8ad6\u3055\u308c\u305f\u578b\u3092\u4f7f\u7528"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u7d50\u8ad6",children:"\u7d50\u8ad6"}),"\n",(0,l.jsx)(n.p,{children:"TypeScript\u306e\u30a2\u30d7\u30ed\u30fc\u30c1\u3092\u7814\u7a76\u3057\u3001Ruby\u306e\u3088\u308a\u30b7\u30f3\u30d7\u30eb\u306a\u30bb\u30de\u30f3\u30c6\u30a3\u30af\u30b9\u306b\u9069\u5fdc\u3055\u305b\u308b\u3053\u3068\u3067\u3001\u5b9f\u7528\u7684\u306a\u578b\u63a8\u8ad6\u30b7\u30b9\u30c6\u30e0\u3092\u69cb\u7bc9\u3057\u307e\u3057\u305f\u3002\u4e3b\u8981\u306a\u6d1e\u5bdf\uff1a"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u30e1\u30bd\u30c3\u30c9\u672c\u4f53\u3092\u30d1\u30fc\u30b9"})," - \u30b3\u30fc\u30c9\u3092\u898b\u306a\u3051\u308c\u3070\u578b\u306f\u63a8\u8ad6\u3067\u304d\u306a\u3044"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u30ad\u30e3\u30c3\u30b7\u30f3\u30b0\u306b\u3088\u308b\u9045\u5ef6\u8a55\u4fa1"})," - \u5fc5\u8981\u306b\u306a\u308b\u307e\u3067\u8a08\u7b97\u3057\u306a\u3044"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Ruby\u30a4\u30c7\u30a3\u30aa\u30e0\u3092\u51e6\u7406"})," - \u6697\u9ed9\u7684\u306a\u623b\u308a\u5024\u3001",(0,l.jsx)(n.code,{children:"initialize"}),"\u306a\u3069"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u30b7\u30f3\u30d7\u30eb\u306b\u59cb\u3081\u308b"})," - \u307e\u305a\u30ea\u30c6\u30e9\u30eb\u3001\u6b21\u306b\u8907\u96d1\u3055\u3092\u5897\u3059"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u578b\u63a8\u8ad6\u306b\u3088\u308aT-Ruby\u306f\u3088\u308a\u81ea\u7136\u306b\u306a\u308a\u307e\u3059\u3002Ruby\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u3001\u578b\u5b89\u5168\u6027\u3092\u5f97\u307e\u3057\u3087\u3046 - \u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3\u4e0d\u8981\u3067\u3002"}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.em,{children:"\u578b\u63a8\u8ad6\u30b7\u30b9\u30c6\u30e0\u306fT-Ruby\u3067\u5229\u7528\u53ef\u80fd\u3067\u3059\u3002\u8a66\u3057\u3066\u307f\u3066\u3001\u3054\u610f\u898b\u3092\u304a\u805e\u304b\u305b\u304f\u3060\u3055\u3044\uff01"})})]})}function o(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},6145(e,n,r){r.d(n,{R:()=>d,x:()=>c});var i=r(7140);const l={},s=i.createContext(l);function d(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:d(e.components),i.createElement(s.Provider,{value:n},e.children)}},8235(e){e.exports=JSON.parse('{"permalink":"/ja/blog/typescript-style-type-inference","editUrl":"https://github.com/type-ruby/t-ruby.github.io/tree/main/blog/2025-12-24-type-inference/index.md","source":"@site/i18n/ja/docusaurus-plugin-content-blog/2025-12-24-type-inference/index.md","title":"T-Ruby\u306e\u305f\u3081\u306eTypeScript\u30b9\u30bf\u30a4\u30eb\u578b\u63a8\u8ad6\u306e\u69cb\u7bc9","description":"\u660e\u793a\u7684\u306a\u578b\u5ba3\u8a00\u306a\u3057\u3067\u81ea\u52d5\u7684\u306b\u578b\u3092\u691c\u51fa\u3059\u308b\u3001TypeScript\u306b\u89e6\u767a\u3055\u308c\u305f\u9759\u7684\u578b\u63a8\u8ad6\u3092T-Ruby\u306b\u5b9f\u88c5\u3057\u305f\u8a71\u3067\u3059\u3002","date":"2025-12-24T00:00:00.000Z","tags":[{"inline":true,"label":"technical","permalink":"/ja/blog/tags/technical"},{"inline":true,"label":"type-inference","permalink":"/ja/blog/tags/type-inference"},{"inline":true,"label":"compiler","permalink":"/ja/blog/tags/compiler"}],"readingTime":6.14,"hasTruncateMarker":true,"authors":[{"name":"Yonghyun Kim","url":"https://github.com/yhk1038","imageURL":"https://github.com/yhk1038.png","key":"yhk1038","page":null}],"frontMatter":{"slug":"typescript-style-type-inference","title":"T-Ruby\u306e\u305f\u3081\u306eTypeScript\u30b9\u30bf\u30a4\u30eb\u578b\u63a8\u8ad6\u306e\u69cb\u7bc9","authors":["yhk1038"],"tags":["technical","type-inference","compiler"]},"unlisted":false,"prevItem":{"title":"T-Ruby \u30d6\u30ed\u30b0\u3078\u3088\u3046\u3053\u305d","permalink":"/ja/blog/welcome"}}')}}]);