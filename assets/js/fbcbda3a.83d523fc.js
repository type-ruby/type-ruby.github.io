"use strict";(globalThis.webpackChunkt_ruby_docs=globalThis.webpackChunkt_ruby_docs||[]).push([[3745],{3255:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>g,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"tooling/rbs-integration","title":"RBS Integration","description":"How T-Ruby generates and works with RBS files","source":"@site/docs/tooling/rbs-integration.md","sourceDirName":"tooling","slug":"/tooling/rbs-integration","permalink":"/docs/tooling/rbs-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/type-ruby/t-ruby.github.io/tree/main/docs/tooling/rbs-integration.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"RBS Integration","description":"How T-Ruby generates and works with RBS files"},"sidebar":"docsSidebar","previous":{"title":"Compiler Options","permalink":"/docs/cli/compiler-options"},"next":{"title":"Using with Steep","permalink":"/docs/tooling/steep"}}');var s=i(2714),t=i(8885);const a={sidebar_position:1,title:"RBS Integration",description:"How T-Ruby generates and works with RBS files"},l="RBS Integration",d={},c=[{value:"What is RBS?",id:"what-is-rbs",level:2},{value:"How T-Ruby Generates RBS",id:"how-t-ruby-generates-rbs",level:2},{value:"Basic Example",id:"basic-example",level:3},{value:"Compilation Options",id:"compilation-options",level:2},{value:"Enable/Disable RBS Generation",id:"enabledisable-rbs-generation",level:3},{value:"RBS Output Directory",id:"rbs-output-directory",level:3},{value:"RBS Features Supported",id:"rbs-features-supported",level:2},{value:"Method Signatures",id:"method-signatures",level:3},{value:"Optional and Keyword Parameters",id:"optional-and-keyword-parameters",level:3},{value:"Block Signatures",id:"block-signatures",level:3},{value:"Generics",id:"generics",level:3},{value:"Union Types",id:"union-types",level:3},{value:"Modules and Mixins",id:"modules-and-mixins",level:3},{value:"Type Aliases",id:"type-aliases",level:3},{value:"Interfaces",id:"interfaces",level:3},{value:"Using Generated RBS Files",id:"using-generated-rbs-files",level:2},{value:"With Steep",id:"with-steep",level:3},{value:"With Ruby LSP",id:"with-ruby-lsp",level:3},{value:"With Sorbet",id:"with-sorbet",level:3},{value:"With Standard Gem",id:"with-standard-gem",level:3},{value:"Advanced RBS Generation",id:"advanced-rbs-generation",level:2},{value:"Custom RBS Annotations",id:"custom-rbs-annotations",level:3},{value:"External RBS Integration",id:"external-rbs-integration",level:3},{value:"Merging RBS Files",id:"merging-rbs-files",level:3},{value:"RBS Validation",id:"rbs-validation",level:2},{value:"RBS and Type Checking Flow",id:"rbs-and-type-checking-flow",level:2},{value:"Practical Examples",id:"practical-examples",level:2},{value:"Example 1: Library Development",id:"example-1-library-development",level:3},{value:"Example 2: Rails Application",id:"example-2-rails-application",level:3},{value:"Example 3: Gem with Type Signatures",id:"example-3-gem-with-type-signatures",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"RBS Generation Fails",id:"rbs-generation-fails",level:3},{value:"RBS Validation Errors",id:"rbs-validation-errors",level:3},{value:"Type Mismatches",id:"type-mismatches",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Keep RBS in Version Control",id:"1-keep-rbs-in-version-control",level:3},{value:"2. Validate RBS in CI",id:"2-validate-rbs-in-ci",level:3},{value:"3. Document Public APIs",id:"3-document-public-apis",level:3},{value:"4. Use Type Aliases for Clarity",id:"4-use-type-aliases-for-clarity",level:3},{value:"5. Combine with Hand-Written RBS",id:"5-combine-with-hand-written-rbs",level:3},{value:"Next Steps",id:"next-steps",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components},{DocsBadge:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("DocsBadge",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i,{}),"\n",(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"rbs-integration",children:"RBS Integration"})}),"\n",(0,s.jsxs)(n.p,{children:["T-Ruby seamlessly integrates with RBS (Ruby Signature), Ruby's official type signature format. When you compile T-Ruby code, the compiler automatically generates ",(0,s.jsx)(n.code,{children:".rbs"})," files alongside the Ruby output, enabling integration with the broader Ruby typing ecosystem."]}),"\n",(0,s.jsx)(n.h2,{id:"what-is-rbs",children:"What is RBS?"}),"\n",(0,s.jsx)(n.p,{children:"RBS is Ruby's standard format for type signatures. It's a separate language for describing the structure of Ruby programs, including:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Method signatures"}),"\n",(0,s.jsx)(n.li,{children:"Class and module definitions"}),"\n",(0,s.jsx)(n.li,{children:"Instance and class variables"}),"\n",(0,s.jsx)(n.li,{children:"Generics and type parameters"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"how-t-ruby-generates-rbs",children:"How T-Ruby Generates RBS"}),"\n",(0,s.jsx)(n.p,{children:"When you compile T-Ruby code, the compiler extracts type information and generates corresponding RBS files."}),"\n",(0,s.jsx)(n.h3,{id:"basic-example",children:"Basic Example"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"T-Ruby input"})," (",(0,s.jsx)(n.code,{children:"user.trb"}),"):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",children:'class User\n  @id: Integer\n  @name: String\n  @email: String\n\n  def initialize(id: Integer, name: String, email: String): void\n    @id = id\n    @name = name\n    @email = email\n  end\n\n  def greet: String\n    "Hello, I\'m #{@name}!"\n  end\n\n  def update_email(new_email: String): void\n    @email = new_email\n  end\nend\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Generated RBS"})," (",(0,s.jsx)(n.code,{children:"sig/user.rbs"}),"):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rbs",children:"class User\n  @id: Integer\n  @name: String\n  @email: String\n\n  def initialize: (Integer id, String name, String email) -> void\n  def greet: () -> String\n  def update_email: (String new_email) -> void\nend\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Generated Ruby"})," (",(0,s.jsx)(n.code,{children:"build/user.rb"}),"):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ruby",children:'class User\n  def initialize(id, name, email)\n    @id = id\n    @name = name\n    @email = email\n  end\n\n  def greet\n    "Hello, I\'m #{@name}!"\n  end\n\n  def update_email(new_email)\n    @email = new_email\n  end\nend\n'})}),"\n",(0,s.jsx)(n.h2,{id:"compilation-options",children:"Compilation Options"}),"\n",(0,s.jsx)(n.h3,{id:"enabledisable-rbs-generation",children:"Enable/Disable RBS Generation"}),"\n",(0,s.jsx)(n.p,{children:"By default, RBS files are generated. You can control this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="trbconfig.yml"',children:"compiler:\n  generate_rbs: true  # Default\n"})}),"\n",(0,s.jsx)(n.p,{children:"Or via command line:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Skip RBS generation\ntrc compile --no-rbs src/\n\n# Generate only RBS (skip Ruby)\ntrc compile --rbs-only src/\n"})}),"\n",(0,s.jsx)(n.h3,{id:"rbs-output-directory",children:"RBS Output Directory"}),"\n",(0,s.jsx)(n.p,{children:"Configure where RBS files are written:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="trbconfig.yml"',children:"output:\n  rbs_dir: sig  # Default\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"trc compile --rbs-dir signatures/ src/\n"})}),"\n",(0,s.jsx)(n.h2,{id:"rbs-features-supported",children:"RBS Features Supported"}),"\n",(0,s.jsx)(n.h3,{id:"method-signatures",children:"Method Signatures"}),"\n",(0,s.jsx)(n.p,{children:"T-Ruby automatically generates method signatures with parameters and return types."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",metastring:'title="calculator.trb"',children:"def add(a: Integer, b: Integer): Integer\n  a + b\nend\n\ndef divide(a: Float, b: Float): Float | nil\n  return nil if b == 0\n  a / b\nend\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rbs",metastring:'title="sig/calculator.rbs"',children:"def add: (Integer a, Integer b) -> Integer\ndef divide: (Float a, Float b) -> (Float | nil)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"optional-and-keyword-parameters",children:"Optional and Keyword Parameters"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",metastring:'title="formatter.trb"',children:'def format(\n  text: String,\n  uppercase: Bool = false,\n  prefix: String? = nil\n): String\n  result = uppercase ? text.upcase : text\n  prefix ? "#{prefix}#{result}" : result\nend\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rbs",metastring:'title="sig/formatter.rbs"',children:"def format: (\n  String text,\n  ?Bool uppercase,\n  ?String? prefix\n) -> String\n"})}),"\n",(0,s.jsx)(n.h3,{id:"block-signatures",children:"Block Signatures"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",metastring:'title="iterator.trb"',children:"def each_item(items: Array<String>): void do |String| -> void end\n  items.each { |item| yield item }\nend\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rbs",metastring:'title="sig/iterator.rbs"',children:"def each_item: (Array[String] items) { (String) -> void } -> void\n"})}),"\n",(0,s.jsx)(n.h3,{id:"generics",children:"Generics"}),"\n",(0,s.jsx)(n.p,{children:"T-Ruby's generic types map directly to RBS generics."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",metastring:'title="container.trb"',children:"class Container<T>\n  @value: T\n\n  def initialize(value: T): void\n    @value = value\n  end\n\n  def get: T\n    @value\n  end\n\n  def set(value: T): void\n    @value = value\n  end\nend\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rbs",metastring:'title="sig/container.rbs"',children:"class Container[T]\n  @value: T\n\n  def initialize: (T value) -> void\n  def get: () -> T\n  def set: (T value) -> void\nend\n"})}),"\n",(0,s.jsx)(n.h3,{id:"union-types",children:"Union Types"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",metastring:'title="parser.trb"',children:'def parse(input: String): Integer | Float | nil\n  return nil if input.empty?\n\n  if input.include?(".")\n    input.to_f\n  else\n    input.to_i\n  end\nend\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rbs",metastring:'title="sig/parser.rbs"',children:"def parse: (String input) -> (Integer | Float | nil)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"modules-and-mixins",children:"Modules and Mixins"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",metastring:'title="loggable.trb"',children:'module Loggable\n  def log(message: String): void\n    puts "[LOG] #{message}"\n  end\n\n  def log_error(error: String): void\n    puts "[ERROR] #{error}"\n  end\nend\n\nclass Service\n  include Loggable\n\n  def process: void\n    log("Processing...")\n  end\nend\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rbs",metastring:'title="sig/loggable.rbs"',children:"module Loggable\n  def log: (String message) -> void\n  def log_error: (String error) -> void\nend\n\nclass Service\n  include Loggable\n\n  def process: () -> void\nend\n"})}),"\n",(0,s.jsx)(n.h3,{id:"type-aliases",children:"Type Aliases"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",metastring:'title="types.trb"',children:"type UserId = Integer\ntype UserMap = Hash<UserId, User>\n\ndef find_users(ids: Array<UserId>): UserMap\n  # ...\nend\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rbs",metastring:'title="sig/types.rbs"',children:"type UserId = Integer\ntype UserMap = Hash[UserId, User]\n\ndef find_users: (Array[UserId] ids) -> UserMap\n"})}),"\n",(0,s.jsx)(n.h3,{id:"interfaces",children:"Interfaces"}),"\n",(0,s.jsx)(n.p,{children:"T-Ruby interfaces are converted to RBS interface types."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",metastring:'title="printable.trb"',children:'interface Printable\n  def to_s: String\n  def print: void\nend\n\nclass Document\n  implements Printable\n\n  def to_s: String\n    "Document"\n  end\n\n  def print: void\n    puts to_s\n  end\nend\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rbs",metastring:'title="sig/printable.rbs"',children:"interface _Printable\n  def to_s: () -> String\n  def print: () -> void\nend\n\nclass Document\n  include _Printable\n\n  def to_s: () -> String\n  def print: () -> void\nend\n"})}),"\n",(0,s.jsx)(n.h2,{id:"using-generated-rbs-files",children:"Using Generated RBS Files"}),"\n",(0,s.jsx)(n.h3,{id:"with-steep",children:"With Steep"}),"\n",(0,s.jsx)(n.p,{children:"Steep can use T-Ruby's generated RBS files for type checking:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="Steepfile"',children:'target :app do\n  signature "sig"  # T-Ruby generated signatures\n  check "build"    # Compiled Ruby files\nend\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"trc compile src/\nsteep check\n"})}),"\n",(0,s.jsx)(n.h3,{id:"with-ruby-lsp",children:"With Ruby LSP"}),"\n",(0,s.jsx)(n.p,{children:"Configure Ruby LSP to use T-Ruby's RBS files:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",metastring:'title=".vscode/settings.json"',children:'{\n  "rubyLsp.enabledFeatures": {\n    "diagnostics": true\n  },\n  "rubyLsp.typechecker": "steep",\n  "rubyLsp.rbs.path": "sig"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"with-sorbet",children:"With Sorbet"}),"\n",(0,s.jsx)(n.p,{children:"Generate Sorbet-compatible type stubs from RBS:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Generate RBS files\ntrc compile --rbs-only src/\n\n# Convert to Sorbet stubs\nrbs-to-sorbet sig/ sorbet/rbi/\n"})}),"\n",(0,s.jsx)(n.h3,{id:"with-standard-gem",children:"With Standard Gem"}),"\n",(0,s.jsx)(n.p,{children:"Import RBS signatures into gems:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ruby",metastring:'title="my_gem.gemspec"',children:'Gem::Specification.new do |spec|\n  spec.name = "my_gem"\n  spec.files = Dir["lib/**/*", "sig/**/*"]\n  spec.metadata["rbs_signatures"] = "sig"\nend\n'})}),"\n",(0,s.jsx)(n.h2,{id:"advanced-rbs-generation",children:"Advanced RBS Generation"}),"\n",(0,s.jsx)(n.h3,{id:"custom-rbs-annotations",children:"Custom RBS Annotations"}),"\n",(0,s.jsx)(n.p,{children:"Add RBS-specific annotations in comments:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rbs",metastring:'title="service.trb"',children:"class Service\n  # @rbs_skip\n  def debug_method: void\n    # This method won't appear in RBS\n  end\n\n  # @rbs_override\n  # def custom_signature: (String) -> Integer\n  def custom_method(input: String): Integer\n    input.length\n  end\nend\n"})}),"\n",(0,s.jsx)(n.h3,{id:"external-rbs-integration",children:"External RBS Integration"}),"\n",(0,s.jsx)(n.p,{children:"Combine T-Ruby's generated RBS with hand-written RBS:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sig/\n\u251c\u2500\u2500 generated/      # T-Ruby generated\n\u2502   \u251c\u2500\u2500 user.rbs\n\u2502   \u2514\u2500\u2500 service.rbs\n\u2514\u2500\u2500 manual/         # Hand-written\n    \u2514\u2500\u2500 external.rbs\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="trbconfig.yml"',children:"output:\n  rbs_dir: sig/generated\n\ntypes:\n  paths:\n    - sig/manual\n    - sig/generated\n"})}),"\n",(0,s.jsx)(n.h3,{id:"merging-rbs-files",children:"Merging RBS Files"}),"\n",(0,s.jsx)(n.p,{children:"If you have existing RBS files:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Generate new RBS\ntrc compile --rbs-only src/\n\n# Merge with existing\nrbs merge sig/generated/ sig/manual/ -o sig/merged/\n"})}),"\n",(0,s.jsx)(n.h2,{id:"rbs-validation",children:"RBS Validation"}),"\n",(0,s.jsx)(n.p,{children:"Validate generated RBS files:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Generate RBS\ntrc compile src/\n\n# Validate with RBS\nrbs validate --signature-path=sig/\n"})}),"\n",(0,s.jsx)(n.p,{children:"T-Ruby ensures generated RBS is always valid, but validation is useful when:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Combining with hand-written RBS"}),"\n",(0,s.jsx)(n.li,{children:"Using external type definitions"}),"\n",(0,s.jsx)(n.li,{children:"Debugging type issues"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"rbs-and-type-checking-flow",children:"RBS and Type Checking Flow"}),"\n",(0,s.jsx)(n.p,{children:"Here's how T-Ruby's RBS integration fits into type checking:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  .trb files \u2502\n\u2502  (T-Ruby)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502  trc   \u2502  Compile\n   \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n       \u25bc          \u25bc\n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n \u2502 .rb files\u2502  \u2502.rbs files\u2502\n \u2502 (Ruby)   \u2502  \u2502  (RBS)   \u2502\n \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502            \u2502\n       \u2502            \u25bc\n       \u2502      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n       \u2502      \u2502  Steep   \u2502  Type check\n       \u2502      \u2502 Ruby LSP \u2502\n       \u2502      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2502   Ruby   \u2502  Execute\n  \u2502Interpreter\u2502\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(n.h2,{id:"practical-examples",children:"Practical Examples"}),"\n",(0,s.jsx)(n.h3,{id:"example-1-library-development",children:"Example 1: Library Development"}),"\n",(0,s.jsx)(n.p,{children:"Create a typed library with RBS:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",metastring:'title="lib/my_library.trb"',children:'module MyLibrary\n  class Client\n    @api_key: String\n    @endpoint: String\n\n    def initialize(api_key: String, endpoint: String = "https://api.example.com"): void\n      @api_key = api_key\n      @endpoint = endpoint\n    end\n\n    def get<T>(path: String, params: Hash<String, Any> = {}): T | nil\n      # Implementation\n    end\n\n    def post<T>(path: String, body: Hash<String, Any>): T\n      # Implementation\n    end\n  end\nend\n'})}),"\n",(0,s.jsx)(n.p,{children:"Compile:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"trc compile lib/\n"})}),"\n",(0,s.jsx)(n.p,{children:"Generated files:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"lib/\n\u251c\u2500\u2500 my_library.rb   # For runtime\nsig/\n\u2514\u2500\u2500 my_library.rbs  # For type checking and documentation\n"})}),"\n",(0,s.jsx)(n.p,{children:"Users can now:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ruby",children:'# Use in Ruby\nrequire "my_library"\nclient = MyLibrary::Client.new("key123")\n\n# Type check with Steep\n# steep check uses sig/my_library.rbs\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example-2-rails-application",children:"Example 2: Rails Application"}),"\n",(0,s.jsx)(n.p,{children:"Use RBS with Rails models:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",metastring:'title="app/models/user.trb"',children:"class User < ApplicationRecord\n  @name: String\n  @email: String\n  @admin: Bool\n\n  def self.find_by_email(email: String): User | nil\n    find_by(email: email)\n  end\n\n  def admin?: Bool\n    @admin\n  end\n\n  def promote_to_admin: void\n    update!(admin: true)\n  end\nend\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="trbconfig.yml"',children:"source:\n  include:\n    - app/models\n\noutput:\n  ruby_dir: app/models\n  rbs_dir: sig\n"})}),"\n",(0,s.jsx)(n.p,{children:"Compile:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"trc compile\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now Steep can check your Rails app:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="Steepfile"',children:'target :app do\n  signature "sig"\n  check "app"\n\n  library "activerecord"\nend\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example-3-gem-with-type-signatures",children:"Example 3: Gem with Type Signatures"}),"\n",(0,s.jsx)(n.p,{children:"Package RBS with your gem:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ruby",metastring:'title="my_gem.gemspec"',children:'Gem::Specification.new do |spec|\n  spec.name = "my_typed_gem"\n  spec.version = "1.0.0"\n\n  spec.files = Dir[\n    "lib/**/*.rb",\n    "sig/**/*.rbs"\n  ]\n\n  spec.metadata = {\n    "rbs_signatures" => "sig"\n  }\nend\n'})}),"\n",(0,s.jsx)(n.p,{children:"Users automatically get type information when using your gem."}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"rbs-generation-fails",children:"RBS Generation Fails"}),"\n",(0,s.jsx)(n.p,{children:"If RBS generation fails:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check compilation with verbose output\ntrc compile --verbose src/\n\n# Validate T-Ruby types first\ntrc check src/\n\n# Generate RBS separately\ntrc compile --rbs-only src/\n"})}),"\n",(0,s.jsx)(n.h3,{id:"rbs-validation-errors",children:"RBS Validation Errors"}),"\n",(0,s.jsx)(n.p,{children:"If RBS validation fails:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check specific RBS file\nrbs validate sig/user.rbs\n\n# View generated RBS\ncat sig/user.rbs\n\n# Re-generate with debug\ntrc compile --log-level debug src/\n"})}),"\n",(0,s.jsx)(n.h3,{id:"type-mismatches",children:"Type Mismatches"}),"\n",(0,s.jsx)(n.p,{children:"If types don't match between T-Ruby and RBS:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check what RBS was generated\ntrc compile --rbs-only --output-file - src/user.trb\n\n# Use type tracing\ntrc compile --trace src/\n"})}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"1-keep-rbs-in-version-control",children:"1. Keep RBS in Version Control"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'git add sig/\ngit commit -m "Update RBS signatures"\n'})}),"\n",(0,s.jsx)(n.p,{children:"RBS files are source code - commit them alongside Ruby files."}),"\n",(0,s.jsx)(n.h3,{id:"2-validate-rbs-in-ci",children:"2. Validate RBS in CI"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title=".github/workflows/ci.yml"',children:"- name: Generate and Validate RBS\n  run: |\n    trc compile src/\n    rbs validate --signature-path=sig/\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-document-public-apis",children:"3. Document Public APIs"}),"\n",(0,s.jsx)(n.p,{children:"RBS files serve as documentation. Ensure public APIs are well-typed:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",children:"# Good - clear public API\nclass Service\n  def process(data: Array<String>): Hash<String, Integer>\n    # ...\n  end\n\n  private\n\n  def internal_helper(x)  # Private can be untyped\n    # ...\n  end\nend\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-use-type-aliases-for-clarity",children:"4. Use Type Aliases for Clarity"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-trb",children:"type UserId = Integer\ntype ResponseData = Hash<String, Any>\n\ndef fetch_user(id: UserId): ResponseData\n  # ...\nend\n"})}),"\n",(0,s.jsx)(n.h3,{id:"5-combine-with-hand-written-rbs",children:"5. Combine with Hand-Written RBS"}),"\n",(0,s.jsx)(n.p,{children:"Keep generated and manual RBS separate:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sig/\n\u251c\u2500\u2500 generated/     # From T-Ruby\n\u2514\u2500\u2500 manual/        # Hand-written\n"})}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/tooling/steep",children:"Using Steep"})," - Type check with Steep"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/tooling/ruby-lsp",children:"Ruby LSP Integration"})," - IDE support"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/ruby/rbs",children:"RBS Official Documentation"})," - Learn more about RBS"]}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8885:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>l});var r=i(9378);const s={},t=r.createContext(s);function a(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);